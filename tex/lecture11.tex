
\newcommand*{\threesim}{%
\mathrel{\vcenter{\offinterlineskip
\hbox{$\sim$}\vskip-.45ex\hbox{$\sim$}\vskip-.45ex\hbox{$\sim$}}}}


\chapter{Limits and colimits}
\lecturedetails{9 November 2017}{M Fiore, S Lau, D Szamozvancev}

We can generalize products and coproducts, amongst other notions in category
theory, using the idea of limits and colimits. We begin with a motivating
example.

\section{Example: lub of $\omega$-chains}

Consider a preorder $(P, \leq)$ interpreted as a category  $\lscat{P}$.

In $\lscat{P}$,  products are meets ($\wedge$) and coproducts are joins
($\vee$). These constructions were previously defined for \emph{pairs} of
elements.

In domain theory, we are interested in other kinds of least upper bounds. In
particular, we are interested in least upper bounds of $\omega$-chains
(countably increasing chains)
\[
	x_0 \leq x_1 \leq x_2 \leq \cdots \leq x_n \leq \cdots \quad (n \in \nats)
\]

The least upper bound of a chain $x_n$, if it exists, is denoted $\lub_{n \in
    \nats}$ and in $\lscat{P}$ is analogous to the ``least upper bound of the
join construction''.

In order to generalize these kinds of constructions in a category, we need
something analogous to the $\omega$-chain and to taking the least upper bound.

\subsection{Colimits of $\omega$-chains}

\begin{definition}[$\omega$-chain]
Informally, an $\omega$-chain in a category is given by a family of objects
$X_i$ with a map from $X_i$ to $X_{i+1}$ for $i \in \nats$.
\[
    X_0 \morpharrow X_1 \morpharrow X_2 \morpharrow \cdots \morpharrow X_i
    \morpharrow \cdots
\]

Formally, consider the category $\underline{\omega}$ with objects the natural
numbers and arrows $m \morpharrow n$ iff $m \leq n$. An $\omega$-chain in a
category $\lscat{C}$ is nothing but a functor $X : \underline{\omega} \to
\lscat{C}$ such that
\begin{align*}
	n & \mapsto X_n & (\text{object map}) \\
	(m \leq n) & \mapsto (X_m \morpharrow X_n) &(\text{morphism map})
\end{align*}

\end{definition}

\begin{definition}[Colimits of $\omega$-chains]
The colimit of an $\omega$-chain
\[
    X_0 \morpharrow X_1 \morpharrow X_2 \morpharrow \cdots \morpharrow X_i
    \morpharrow \cdots
\]
consists of an (initial universal) object $C$ (called a \emph{cocone}, with dual
\emph{cone} for limits) and a family of arrows $\langle \gamma_n : X_n
\morpharrow C \rangle _{n \in \nats}$

\begin{center}
\begin{tikzcd}[row sep=2cm, column sep=2cm]
X_0    \arrow[r]
	   \arrow[drr,"\gamma_0",swap] &
X_1    \arrow[r]
	   \arrow[dr,"\gamma_1",swap]  &
\cdots \arrow[r]
	   \arrow[d,dashed]            &
X_n    \arrow[r]
	   \arrow[dl, "\gamma_n"]      &
\cdots \arrow[dll, dashed]
\\
&& C
\end{tikzcd}
\end{center}

such that the following diagram commutes $\forall n \in \nats$.

\begin{center}
\begin{tikzcd}[column sep=small]
X_n     \arrow[rr]
	    \arrow[dr, "\gamma_n", swap] &&
X_{n+1} \arrow[dl, "\gamma_{n+1}"]
\\
& C
\end{tikzcd}
\end{center}

The cocone $(C, \gamma_n)$ is initial universal, which means that for any other
object $D$ and family of arrows
$\langle \delta_n : X_n \rightarrow D\rangle_{n \in \nats}$ such that the
following diagram commutes,
\begin{center}
\begin{tikzcd}[column sep=small]
X_n     \arrow[rr]
	    \arrow[dr, "\delta_n", swap] &&
X_{n+1}
	    \arrow[dl, "\delta_{n+1}"]
\\
& D
\end{tikzcd}
\end{center}

there exists a unique map
\[
	C \morpharr{\exists ! u} D
\]
such that the following commutes for all $n \in \nats$.
\begin{center}
\begin{tikzcd}[column sep=small]
& X_n \arrow[dl, "\gamma_n",swap]
	  \arrow[dr, "\delta_n"]
\\
C     \arrow [rr, "u",swap]
&& D
\end{tikzcd}
\end{center}

Intuitively, this universal property captures the notion of ``least'' upper
bound in the context of preorders. For if $D$ is also an upper bound, then there
is a (unique) arrow from $C$ to $D$, expressing ``$C \leq D$''.

\end{definition}

This idea of a colimit generalizes to other diagrams. For instance, consider the
following expressing countable sums (the colimit is denoted by $\coprod Y_k$).
\begin{center}
\begin{tikzcd}[column sep=small]
& {Y_n\ (n \in \nats)}
	\arrow[dl, "\iota_k",swap]
	\arrow[dr, "\delta_n"]
\\
\coprod_{k \in \nats} Y_k
	\arrow [rr, "\exists ! u",swap, dashed]
&& D
\end{tikzcd}
\end{center}

N.B.~$Y_n$ is discrete, whereas the $\omega$-chain used above in defining
colimits had structure. We can define limits and colimits for arbitrary
diagrams, though they may not necessarily exist.

\section{Coequalisers}

As another useful example of a colimit, we consider the diagram called a \emph{parallel pair}, consisting of two objects in a category $\lscat C$ with two parallel morphisms between them:

\begin{center}
\begin{tikzcd}
    A \arrow[r, shift left=5pt, "f"]
      \arrow[r,shift right=5pt, swap, "g"]
    & B
\end{tikzcd}
\end{center}

\begin{definition}[Coequaliser]
A \emph{coequaliser} is the colimit of a parallel pair diagram.
\end{definition}

As before, to define the coequaliser, we start by finding a suitable cocone for this diagram:

\begin{center}
\begin{tikzcd}[column sep=1.5em, row sep=2.5em]
    A \arrow[rr, shift left=5pt, "f"]
      \arrow[rr, shift right=5pt, swap, "g"]
      \arrow[rd, "\alpha", swap]
    & {}
    & B \arrow[ld, "\beta"]
    \\
    {} & C
\end{tikzcd}
\end{center}

We want this diagram to commute for both arrows, \ie\ $\beta \comp f = \alpha$ and $\beta \comp g = \alpha$. In fact, we don't need $\alpha$ as it can just be defined in terms of $\beta$. All we need is to find a $\beta : B \to C$ such that $\beta \comp f = \beta \comp g$, that is, a function which equalises $f$ and $g$. The universal initial solution to this problem is the \emph{coequaliser} of $f$ and $g$: for all other $\zeta : B \to Z$ which equalise $f$ and $g$, there exists a unique arrow $u : Z \to C$ such that the following diagram commutes:


\begin{center}
\begin{tikzcd}
      A \arrow[r, shift left=5pt, "f"]
        \arrow[r,shift right=5pt, swap, "g"]
    & B \arrow[r, "\beta"]
        \arrow[rd, swap, "\forall \zeta"]
    & C \arrow[d, dashed, "\exists! u"]
    \\
    {} & {} & \forall Z

\end{tikzcd}
\end{center}

\subsection{Coequalisers in sets}
Let's consider coequalisers in the familiar category of sets.

\begin{center}
\begin{tikzcd}
      S \arrow[r, shift left=5pt, "f"]
        \arrow[r, shift right=5pt, swap, "g"]
    & T \arrow[r, "\kappa"]
    & K
\end{tikzcd}
\end{center}

Given two sets $S$ and $T$, with two functions $f, g : S \to T$, the coequaliser $\kappa : T \to K$ of $S$ and $T$ is a function such that $\kappa \comp f = \kappa \comp g$, that is,

\begin{equation*}
    \forall s \in S.\ \kappa (f(s)) = \kappa (g(s))
\end{equation*}

We want to find a way of forcing $f(s)$ to equal $g(s)$. Looking closer at the set $T$, we would like to identify $f(s)$ and $g(s)$ for all $s \in S$.

\begin{center}
\begin{tikzpicture}
    [
        group/.style={ellipse, draw, minimum height=20pt,
                      minimum width=50pt, label=right:#1},
        subgroup/.style={rounded corners=10, draw, dashed},
        dot/.style={circle, fill, minimum width=2.5pt, inner sep=0pt}
    ]
    \node (fs) {$f(s)$};
    \node (gs) [below=10pt of fs] {$g(s)$};
    \node (fsp) [right=10pt of fs] {$f(s')$};
    \node (gsp) [below=10pt of fsp] {$g(s')$};
    \node (fspp) [below=10pt of gs] {$f(s'')$};
    \node (gspp) [right=10pt of fspp] {$g(s'')$};
    \node (s) [fit=(fs) (gs), subgroup] {};
    \node (sp) [fit=(fsp) (gsp), subgroup] {};
    \node (spp) [fit=(fspp) (gspp), subgroup] {};
    \node [fit=(s) (sp) (spp), group=T] {};
\end{tikzpicture}
\end{center}

Moreover, if, for example, $f(s)$ was equal to $g(s')$, we would like all of $f(s)$, $g(s)$, $f(s')$ and $g(s')$ to be equal -- or, at least, equivalent. This suggests defining an equivalence relation ensuring that the above elements all reside in the same equivalence class. The function $\kappa$ would then map every element $t \in T$ to its corresponding equivalence class in $K$, and therefore $K$ would be the \emph{quotient set} of $T$ by the equivalence relation.

Concretely, define the relation $ {}_{f}\hspace{-3px}\approx_{g}\ \subseteq T \times T$ as:

\begin{equation*}
    {}_{f}\hspace{-3px}\approx_{g}\ \eqdef\ \{(f(s), g(s)) \suchthat s \in S\}
\end{equation*}

Now, let ${}_{f}\hspace{-3px}\threesim_{g}$ be the least equivalence relation that contains ${}_{f}\hspace{-3px}\approx_{g}$. That is, if $x \threesim y$, then there is a chain of elements $z_0, z_1, \ldots, z_n$ such that $x = z_0 \approx z_1 \approx \ldots \approx z_n = y$. Now, we define the coequaliser $\kappa$ of $f$ and $g$ as a function from $T$ to the quotient set $T / \threesim$ (set of equivalence classes of $T$ under $\threesim$):

\begin{center}
\begin{tikzcd}[row sep=0.2em]
      S \arrow[r, shift left=5pt, "f"]
        \arrow[r, shift right=5pt, swap, "g"]
    & T \arrow[r, "\kappa"]
    & T / \threesim
    \\
    {}
    & t \arrow[r, mapsto]
    & \left[ t \right]_{\threesim}

\end{tikzcd}
\end{center}

\begin{exercise}
    Show that this definition has the universal property of coequalisers.
\end{exercise}

\section{Other examples of colimits}

\subsection{Pushouts}

Consider the following diagram, called a \emph{span}:

\begin{center}
\begin{tikzcd}
    C \arrow[r, "g"] \arrow[d, "f", swap]
    & B
    \\
    A
\end{tikzcd}
\end{center}

To find its colimit, once again, we construct the required commuting cocones:

\begin{center}
\begin{tikzcd}
    C \arrow[r, "g"] \arrow[d, "f", swap] \arrow[rd, "\gamma"]
    & B \arrow[d, "\beta"]
    \\
    A \arrow[r, "\alpha"]
    & K
\end{tikzcd}
\end{center}

We require this diagram to commute, \ie\ $\alpha \comp f = \beta \comp g = \gamma$ (again, $\gamma$ can be defined from $\beta$ so it is usually omitted). We also require the colimit to be the universal initial solution: for all other potential limits $X$, there is a unique function from $K$ to $X$ such that the following diagram commutes:


\begin{center}
\begin{tikzcd}
    C \rar{g} \dar[swap]{f}
    & B \arrow[d, "\beta"] \arrow[ddr, bend left=30, "\forall v"] &[-0.5em] {}
    \\
    A \arrow[r, "\alpha"] \arrow[rrd, bend right=30, "\forall u"]
    & K \arrow[rd, dashed, "\exists! w"] & {}
    \\[-0.5em]
    && \forall X
\end{tikzcd}
\end{center}


This looks quite similar to the coproduct diagram, so our initial guess could be $K = A + B$:


\begin{center}
\begin{tikzcd}
    C \rar{g} \dar[swap]{f}
    & B \arrow[d, "\iota_2"]
    \\
    A \arrow[r, "\iota_1"]
    & A + B

\end{tikzcd}
\end{center}

However, because of $C$ and the extra arrows $f$ and $g$, this diagram does not commute: we can't have $\iota_1 \comp f = \iota_2 \comp g$, since $\iota_1$ and $\iota_2$ have disjoint ranges. The trick is to equalise $\iota_1$ and $\iota_2$ with a coequaliser $c = \text{coeq} (\iota_1 \comp f,\ \iota_2 \comp g )$ (denoted by $\twoheadrightarrow$):


\begin{center}
\begin{tikzcd}
    C \rar{g} \dar[swap]{f}
    & B \arrow[d, "\iota_2"] \arrow[ddr, bend left=30, "\beta"]
    &[-0.5em] {}
    \\
    A \arrow[r, "\iota_1"] \arrow[drr, bend right=30, "\alpha"]
    & A + B \arrow[rd, two heads, "c"] & {}
    \\[-0.5em]
    && K
\end{tikzcd}
\end{center}

This construction, called a \emph{pushout}, is the colimit of the span. The following notation is used to combine the summation and coequaliser operations:

\begin{center}
\begin{tikzcd}
    C \rar{g} \dar{f} \arrow[dr, phantom, "\ulcorner" font=\Large, very near end]
    & B \dar{\beta}
    \\
    A \rar[swap]{\alpha}
    & K
\end{tikzcd}
\end{center}

\exercise{Show that the pushout satisfies the colimit properties (initial universal solution).}

In $\catset$, the pushout is the quotient set (by the appropriate equivalence relation) of the disjoint union of $A$ and $B$.


\begin{center}
\begin{tikzcd}
    C \rar \dar \arrow[dr, phantom, "\ulcorner" font=\Large, very near end]
    & B \dar
    \\
    A \rar
    & (A \uplus B) / \threesim
\end{tikzcd}
\end{center}

\subsection{Arbitrary diagrams}

So far we looked at special cases of colimits for $\omega$-chains, countable sums, coequalisers and pushouts. However, the construction we saw in the previous section can be applied to any finite diagram to find its colimit.

\begin{proposition}
If a category has all finite sums and coequalisers, all finite diagrams have colimits.
\end{proposition}

In fact, we can state a more general result:

\begin{proposition}
If a category has all small coproducts and coequalisers, all small diagrams have colimits.
\end{proposition}

To demonstrate this, consider an arbitrary diagram such as this one:

\begin{center}
\begin{tikzcd}
C \arrow[r] \arrow[d] & B \arrow[r] \arrow[d] & E \\
A \arrow[r] & D &
\end{tikzcd}
\end{center}

The ``algorithm'' for finding its colimit is simply a repetition of the construction we performed for pushouts: find the sum of two objects and take the coequaliser of its injections. Repeat this on the pairwise colimits until the colimit of the whole diagram is reached.

\begin{center}
\begin{minipage}{0.23\textwidth}

\begin{tikzcd}[column sep=12pt, row sep=12pt]
C \arrow[r] \arrow[d] & B \arrow[r] \arrow[d] \arrow[dd, bend left] & E \\
A \arrow[r] \arrow[rd] & D &  \\
 & A + B \arrow[r, two heads] & K
\end{tikzcd}

\end{minipage}\hfill\vline\hfill%
\begin{minipage}{0.33\textwidth}

\begin{tikzcd}[column sep=12pt, row sep=12pt]
C \arrow[r] \arrow[d] & B \arrow[r] \arrow[d] \arrow[dd, bend left] & E &  \\
A \arrow[r] \arrow[rd] & D \arrow[r] & K + D \arrow[r, two heads] & L \\
 & A + B \arrow[r, two heads] & K \arrow[u] &
\end{tikzcd}

\end{minipage}\hfill\vline\hfill%
\begin{minipage}{0.4\textwidth}

\begin{tikzcd}[column sep=12pt, row sep=12pt]
C \arrow[r] \arrow[d] & B \arrow[r] \arrow[d] \arrow[dd, bend left] & E \arrow[r] & L + E \arrow[r, two heads] & M \\
A \arrow[r] \arrow[rd] & D \arrow[r] & K + D \arrow[r, two heads] & L \arrow[u] &  \\
 & A + B \arrow[r, two heads] & K \arrow[u] &  &
\end{tikzcd}

\end{minipage}
\end{center}
